schema: '2.0'
stages:
  filter-tracklist:
    cmd: python src/filter_tracklist.py
    deps:
    - path: data/raw/fma_metadata/
      md5: 8f6b6fdb905c130601c842a519e2d694.dir
      size: 1464836461
      nfiles: 12
    - path: data/raw/fma_small
      md5: 572ddb300c2bf3bd3076ffbd731b4cb9.dir
      size: 7975472258
      nfiles: 8002
    - path: src/filter_tracklist.py
      md5: c7684465572612c46b17ffd2e048d67a
      size: 715
    outs:
    - path: data/processed/tracks_small.csv
      md5: 2077baca74f42a00e3bf2ca3202cb4a4
      size: 1495628
  clean-up-tracklist:
    cmd: python src/clean_up_genre.py
    deps:
    - path: data/processed/tracks_small.csv
      md5: 2077baca74f42a00e3bf2ca3202cb4a4
      size: 1495628
    - path: data/raw/fma_metadata/
      md5: 8f6b6fdb905c130601c842a519e2d694.dir
      size: 1464836461
      nfiles: 12
    - path: src/clean_up_genre.py
      md5: 720f08afd74aad67e608787df83e63cd
      size: 1148
    outs:
    - path: data/processed/clean_tracks_small.csv
      md5: 2f769b74ea508de21efe3aa2a85cd85a
      size: 188116
  split-data:
    cmd: python src/split_data.py
    deps:
    - path: data/processed/clean_tracks_small.csv
      md5: 2f769b74ea508de21efe3aa2a85cd85a
      size: 188116
    - path: src/split_data.py
      md5: 85b6df17c97df36c3e1454fa5bffca01
      size: 1526
    params:
      params.yaml:
        test_set_size: 0.1
        valid_set_size: 0.1
    outs:
    - path: data/final/testing_set.csv
      md5: e806697f800d96924b7cefbc8c6b8300
      size: 18836
    - path: data/final/training_set.csv
      md5: 0c215ca6ccb1b060e83d19e8e9dc6146
      size: 150500
    - path: data/final/validation_set.csv
      md5: 18cee0027ae94af8534dea986e75e506
      size: 18860
  train model:
    cmd: python -m src.train
    deps:
    - path: data/final/training_set.csv
      md5: 0c215ca6ccb1b060e83d19e8e9dc6146
      size: 150500
    - path: data/raw/fma_small/
      md5: 572ddb300c2bf3bd3076ffbd731b4cb9.dir
      size: 7975472258
      nfiles: 8002
    - path: src/train.py
      md5: c41d002045d4aca3e05b56848b501a76
      size: 1045
    params:
      params.yaml:
        batch_size: 16
        learning_rate: 1e-05
        limit_train_batches: 20
        max_epochs: 1
        num_workers: 3
    outs:
    - path: models/model.pt
      md5: a9460b2f338699684f19c80f5d6f056d
      size: 41936620
