schema: '2.0'
stages:
  filter-tracklist:
    cmd: python src/filter_tracklist.py
    deps:
    - path: data/raw/fma_metadata/
      md5: 8f6b6fdb905c130601c842a519e2d694.dir
      size: 1464836461
      nfiles: 12
    - path: data/raw/fma_small
      md5: 572ddb300c2bf3bd3076ffbd731b4cb9.dir
      size: 7975472258
      nfiles: 8002
    - path: src/filter_tracklist.py
      md5: 4b25f61fe5a6afab7e10b7f9695fd455
      size: 763
    outs:
    - path: data/processed/tracks_small.csv
      md5: 2077baca74f42a00e3bf2ca3202cb4a4
      size: 1495628
  clean-up-tracklist:
    cmd: python src/clean_up_genre.py
    deps:
    - path: data/processed/tracks_small.csv
      md5: 2077baca74f42a00e3bf2ca3202cb4a4
      size: 1495628
    - path: data/raw/fma_metadata/
      md5: 8f6b6fdb905c130601c842a519e2d694.dir
      size: 1464836461
      nfiles: 12
    - path: src/clean_up_genre.py
      md5: 720f08afd74aad67e608787df83e63cd
      size: 1148
    outs:
    - path: data/processed/clean_tracks_small.csv
      md5: 2f769b74ea508de21efe3aa2a85cd85a
      size: 188116
  split-data:
    cmd: python src/split_data.py
    deps:
    - path: data/processed/clean_tracks_small.csv
      md5: 2f769b74ea508de21efe3aa2a85cd85a
      size: 188116
    - path: src/split_data.py
      md5: e5fd4e5ff0c7dc5dfa08fd483c24c9f8
      size: 1574
    params:
      params.yaml:
        test_set_size: 0.1
        valid_set_size: 0.1
    outs:
    - path: data/final/testing_set.csv
      md5: 67e54511ce1332cfa197e657e7536d41
      size: 18830
    - path: data/final/training_set.csv
      md5: 327b899d11ea048dd52fad927bc6d11f
      size: 150496
    - path: data/final/validation_set.csv
      md5: 8e3d75c331a9a3e38b25c29323884552
      size: 18870
  train model:
    cmd: python -m src.train
    deps:
    - path: data/final/training_set.csv
      md5: 327b899d11ea048dd52fad927bc6d11f
      size: 150496
    - path: data/final/validation_set.csv
      md5: 8e3d75c331a9a3e38b25c29323884552
      size: 18870
    - path: data/raw/fma_small/
      md5: 572ddb300c2bf3bd3076ffbd731b4cb9.dir
      size: 7975472258
      nfiles: 8002
    - path: src/dataset.py
      md5: 6db21a6d9f71c9cadb962010ad8a4303
      size: 1871
    - path: src/model.py
      md5: d8ddc87c9cf5f57a1d34f1b17978bb2b
      size: 3156
    - path: src/train.py
      md5: 90d7509437f706d3a8211849c0e7ff56
      size: 2508
    params:
      params.yaml:
        batch_size: 256
        learning_rate: 1e-05
        max_epochs: -1
        num_workers: 44
    outs:
    - path: experiments/training/checkpoints
      md5: 692ebe68727d6737e1a92e8bc509cb7a.dir
      size: 83136862
      nfiles: 2
    - path: experiments/training/metrics.json
      md5: eca9ba9e8d170526a9ea85367ae19a24
      size: 113
    - path: experiments/training/plots
      md5: 71b442c7a05010d8b68d98289746356d.dir
      size: 25685
      nfiles: 3
